## ScanM formGenerator - formGenerator for IgorPro

e.g. for experimental header files (beta)

### Installation

1. If not already present, make a folder called ```ScanM``` under ```...\Igor Pro 6 User Files\User Procedures```.

2. Copy all files into ```...\Igor Pro 6 User Files\User Procedures\ScanM```

3. Create in the directory ```...\Igor Pro 6 User Files\Igor Procedures``` a shortcut to 
   ```...\Igor Pro 6 User Files\User Procedures\ScanM\ScM_formGenerator_GUI.ipf```

When IgorPRO is next started, a new menu entry ```ScanM``` should appear.

#### Igor Functions

* ```function FG_createForm(sWinName)```
  
  Generates a new form using ``template.txt`` in the present directory.

* ```function FG_updateKeyValueLists (sFPath, sFName)```

  Update key-value lists from .ini file, with ``sFPath``, a full or partial path to folder for the header file, w/o final 
  "\\", and ``sFName``, the name of header file (``.ini`` file) w/o file extension.

* ``function FG_updateForm ()``

  Update form from key-value lists.

* ``function FG_saveToINIFile (sFPath, sFName, doOverwrite)``

  Saves key-value list to a experimental header file. The file must not yet exist. With ``sFPath``, a full or partial path to 
  folder for the header file, w/o final "\\", ``sFName`` the name of header file (``.ini`` file) w/o file extension, and 
  ``doOverwrite`` (0=abort if file exists; 1=overwrite file after making a backup copy).  Note that no copies are overwritten.

##### Python Functions

The file parseExperimentalHeaderFile.py is a script for importing experimental header files to Python and storing the contents in a dataframes (i.e. as labelled tables). The script contains four functions:

* ```importAllHeaders()```

  Master function which runs the other functions. Returns a dictionary containing the headerfiles, with the 
  key values as the filepath where the headerfile was found.

* ```findExperimentalHeaders()``` 

  Searches a specified folder for header files. Will search all subfolders. Can discover many configuration files, each of which
  is stored as a separate list entry. Returns a list of file locations.

* ```parseFileLocation(headerfiles, docker)``` 

  Parses the list of file locations generated by the previous function and retrieves the files from the specified locations. 
  Due to differences in the naming conventions accepted by Python Notebooks running inside Docker containers and those running
  on desktop computers, it accepts a flag which allows it to parse the different directory string formats. Set this to False
  if you are not using a docker instance.

* ```readExperimentalHeader()``` 
  
  Parses the experimental header file, storing each entry in a dataframe, where the key of the entry becomes a label for that 
  particular row. 

